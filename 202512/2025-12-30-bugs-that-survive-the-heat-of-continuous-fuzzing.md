# Bugs that survive the heat of continuous fuzzing
- URL: https://github.blog/security/vulnerability-research/bugs-that-survive-the-heat-of-continuous-fuzzing/
- Added At: 2025-12-30 14:13:54
- Tags: #read #security

## TL;DR
本文分析了模糊测试下漏洞依然存活的原因（如低代码覆盖率、外部依赖未测试等），并以三个开源项目为例说明。提出五步工作流程（代码优化、覆盖率提升、上下文增强等），强调需结合人工监督改进测试效果。

## Summary
本篇文章探讨了在持续模糊测试下仍然存活的漏洞问题，并以三个开源项目为例分析了原因，最后提出了一套五步模糊测试工作流程来改进测试效果。

### 一、核心观点
模糊测试虽能发现大量漏洞，但并非万能。持续模糊测试下，部分漏洞仍可能长期存在，原因包括代码覆盖率低、外部依赖未测试、测试侧重偏差等。因此，模糊测试需要人工监督和主动优化。

### 二、漏洞存活的案例
1. **GStreamer多媒体框架**：  
   - 已模糊测试7年，但仅有两个模糊器和约19%的代码覆盖率。  
   - 对比项目如OpenSSL有139个模糊器，bzip2覆盖率达93%，显示GStreamer覆盖不足。  
   - 问题根源：模糊测试需人工监控覆盖率和编写新测试，且开发者可能过度依赖自动化而忽视维护。

2. **Poppler PDF解析库**：  
   - 有16个模糊器，覆盖率达60%，但漏洞仍存。  
   - 原因：依赖库（如freetype、cairo）未被充分测试，且默认依赖DjVuLibre未被包含在模糊测试中，导致攻击面暴露。  
   - 启示：软件安全受最弱依赖影响，需全面测试依赖链。

3. **Exiv2图像元数据处理库**：  
   - 已模糊测试3年，但新漏洞仍被研究人员发现。  
   - 原因：测试通常侧重解码功能，而编码逻辑漏洞被忽视，但编码漏洞在自动化流程（如缩略图生成）中可能更危险。

### 三、五步模糊测试工作流程
作者提出系统化流程以提高测试质量：

1. **代码准备**：优化代码以适应模糊测试，如移除校验和、减少随机性、处理信号等。  
2. **提高代码覆盖率**：  
   - 迭代运行测试、检查覆盖报告、改进覆盖（如编写新测试用例）。  
   - 目标覆盖率应＞90%，并测试所有攻击面（包括编码、网络发送等）。  
   - 采用高级技术：故障注入（模拟异常条件）和快照模糊测试（针对有状态程序）。  
3. **提高上下文敏感覆盖率**：  
   - 标准模糊测试跟踪边覆盖（控制流图中的转移），但需进一步优化上下文感知。  
   - 示例显示简单边覆盖可能忽略路径差异，需增强测试精度。  
4. **价值评估**：未在摘要中详细展开，但流程强调需评估测试输入的有效性。  
5. **分类处理**：未详细说明，指对发现的问题进行优先级排序和修复。

### 四、总结
模糊测试是强大的安全工具，但需结合人工干预和系统化流程。通过提高覆盖率、测试依赖项和平衡解码/编码测试，可以更有效地发现隐藏漏洞。未来，AI工具有望辅助自动化，但目前仍需人工主导。
