# John Carmack on Inlined Code
- URL: http://number-none.com/blow/blog/programming/2014/09/26/carmack-on-inlined-code.html
- Added At: 2026-01-10 15:35:17
- Tags: #read #design

## TL;DR
约翰·卡马克认为内联代码能减少状态依赖和bug，提升可读性与性能。建议优先内联单次调用函数，用注释分隔代码块，并注重纯函数与一致性执行路径。需根据场景权衡内联与模块化，特别适用于游戏开发等实时系统。

## Summary
本文是约翰·卡马克在2014年回顾其2007年邮件的内容，主要讨论了代码内联和编程风格。核心观点是内联代码有助于减少状态依赖和bug，提升代码可读性和性能稳定性。

**主要论点**：
1. **内联代码的优势**：
   - 减少意外状态依赖和突变，提高代码透明度。
   - 避免深层嵌套导致的性能问题和bug，如输入延迟。
   - 使代码执行路径更直观，便于调试和优化。

2. **编程风格比较**：
   - 比较三种代码组织方式：分散函数（A和B）与内联注释块（C）。卡马克倾向于C风格，即将小函数直接内联到主函数中，用注释分隔。
   - 强调内联可防止函数被误用，减少因多地点调用引发的错误。

3. **实用建议**：
   - 单一调用函数优先内联。
   - 多地点调用时，尝试用标志位集中处理工作。
   - 鼓励使用纯函数（无副作用），并多用const修饰。
   - 避免过度优化导致的条件分支，追求执行路径一致性。
   - 减少代码复制粘贴，提倡使用循环替代重复代码块。

4. **权衡与例外**：
   - 内联可能影响模块化和OOP，需谨慎处理。
   - 在功耗敏感场景（如移动设备），“先执行后抑制”策略可能不适用。

**结论**：内联代码虽非万能，但能显著提升开发效率和代码质量，尤其适合游戏开发等实时系统。卡马克倡导根据实际需求平衡内联与模块化。
