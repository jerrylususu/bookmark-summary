# Freestyle linked lists tricks
- URL: https://nullprogram.com/blog/2025/12/31/
- Added At: 2026-01-06 15:06:57
- Tags: #read #c

## TL;DR
本文介绍了链表的高级优化技巧，在保持基础结构不变的前提下，通过构建哈希Trie或索引表将查找复杂度从O(n)优化到O(1)或O(log n)，适用于静态或频繁查询场景，支持多映射和遍历操作。

## Summary
本文介绍了链表数据结构的高级技巧，重点展示了如何在不改变链表基础结构的前提下，扩展其功能以提高查找效率。

### 链表基础
- 链表是一种灵活的内存分配结构，适合作为数据结构的起点。
- 以键值对字符串（如环境变量）为例，定义链表节点结构体，包含指向下一个节点的指针、键和值。
- 使用 `cut` 函数解析输入字符串，构建链表。
- 展示了两种构建方法：
  - **反向构建（LIFO）**：通过栈式操作将节点插入链表头部，保持反向顺序，最后插入的条目优先匹配。
  - **顺序构建（FIFO）**：使用双指针技巧维护原始顺序，无需分支或虚拟节点。

### 通过树结构加速查找
- 对于频繁查找或长链表，线性查找效率低。
- 在链表节点中添加两个指针，构建侵入式哈希字典（哈希Trie），同时保持链表结构。
- 构造过程：先将节点插入哈希字典，再链接到链表尾部。
- 查找复杂度从 O(n) 提升到 O(log n)，且支持多映射（multi-map）查询。
- 提供了迭代器接口，支持遍历所有匹配项。

### 通过索引表加速查找
- 对于静态链表或查找频繁的场景，构建非侵入式的MSI哈希表作为索引。
- 索引表是扁平数组，与链表结构分离，可针对不同属性构建多个索引。
- 构建步骤：计算链表长度、确定表大小、插入节点到哈希表。
- 查找复杂度为 O(1)，同样支持多映射和迭代器。
- 索引表可灵活扩展，例如根据值长度等属性构建新索引。

### 总结
- 这些技巧允许在保持链表简单性的基础上，按需添加高效查找功能，无需运行时支持，适用于嵌入式系统或WebAssembly等场景。
- 所有代码示例可在 [`list.c`](https://gist.github.com/skeeto/493823d5956dfdc1d95d8c390c2b0e1d) 获取。
