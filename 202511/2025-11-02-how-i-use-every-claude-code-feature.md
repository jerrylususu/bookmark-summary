# How I Use Every Claude Code Feature
- URL: https://blog.sshh.io/p/how-i-use-every-claude-code-feature
- Added At: 2025-11-02 11:20:35

## TL;DR
本文总结了Claude Code的高效使用方法，重点包括：通过CLAUDE.md文件维护项目规范，利用上下文管理保持会话连贯，避免过度依赖自定义命令与子代理。建议结合钩子机制优化工作流，使用SDK快速开发工具，并集成GitHub Actions实现自动化。强调以实际产出为导向，逐步完善AI辅助的工程流程。

## Summary
作者作为业余爱好者和专业人士，广泛使用Claude Code，并分享了其功能实践经验和核心建议。文章强调Claude Code的实用性和灵活性，而非工具的表面差异。

### 核心功能与实践总结
1. **CLAUDE.md文件**  
   - **作用**：作为代码库的“宪法”，提供项目核心规则和上下文。  
   - **最佳实践**：  
     - 从小规模开始，仅针对Claude常犯错误添加约束。  
     - 避免使用`@`直接引用外部文档，而是引导Claude在特定情况下主动查阅。  
     - 提供替代方案，而非单纯禁止某项操作。  
     - 通过简化CLI工具来保持文件简洁，间接优化代码库。  
   - **专业场景**：严格维护，仅收录高频使用工具，并为内容设置长度限制。

2. **上下文管理**  
   - 使用`/context`命令监控200k token上下文的占用情况（如新会话基础占用约10%）。  
   - **工作流建议**：  
     - 避免使用`/compact`（自动压缩不可靠）。  
     - 简单重启：`/clear`后运行`/catchup`（读取git分支变更）。  
     - 复杂任务重启：让Claude将计划转存为`.md`文件，清除状态后重新加载继续。

3. **斜杠命令**  
   - 仅作为快捷提示工具（如`/catchup`读取git变更、`/pr`准备拉取请求）。  
   - 避免过度定制，防止变成需要学习的“魔法命令”，背离自然交互的初衷。

4. **子代理**  
   - **问题**：自定义子代理会割裂上下文，并强加人工流程。  
   - **替代方案**：在`CLAUDE.md`中提供完整上下文，让主代理通过`Task(...`功能动态委托任务给自身副本（“主控-克隆”架构），保持灵活性和整体推理能力。

5. **会话恢复与历史分析**  
   - 使用`claude --resume`和`claude --continue`恢复旧会话，提取错误解决方案以优化工具。  
   - 分析`~/.claude/projects/`中的历史日志，识别常见问题模式。

6. **钩子**  
   - **类型**：  
     - **提交时阻塞钩子**：如预提交检查测试结果，强制Claude在提交前通过测试。  
     - **提示钩子**：非阻塞性反馈。  
   - **原则**：避免在编写阶段阻塞，让代理完成计划后再验证结果。

7. **规划模式**  
   - 业余项目：使用内置规划模式，提前对齐实现步骤。  
   - 专业场景：基于SDK定制规划工具，嵌入内部设计规范和最佳实践。

8. **技能与MCP**  
   - **技能**：优于MCP，通过`SKILL.md`文件暴露CLI和脚本，支持代理动态编写代码与环境交互（“脚本化”模型）。  
   - **MCP新角色**：作为安全网关，仅提供高层次工具（如数据下载），处理认证和边界问题，而非抽象全部API。

9. **SDK应用**  
   - **用途**：  
     - 大规模并行脚本处理（如批量代码重构）。  
     - 为非技术用户构建内部聊天工具。  
     - 快速原型设计任何代理任务（如安全调查）。  
   - 优先于LangChain等复杂框架。

10. **GitHub Actions**  
    - 将Claude Code集成到GHA中，实现自定义自动化（如从Slack触发生成PR）。  
    - 通过日志分析驱动持续改进（如优化`CLAUDE.md`）。

11. **配置设置**  
    - 关键配置：  
      - 使用代理调试网络流量。  
      - 调整超时设置以支持长任务。  
      - 企业级API密钥实现按用量计费。  
      - 定期审核权限列表。

### 总体建议
- 关注最终产出（如PR质量），而非代理过程细节。  
- 通过实践探索高级功能，将Claude Code转化为可审计、自优化的工程系统核心。  
- 对于AI生成的PR，目前建议保留两人人工审核，以应对范式转变。
