# Exposition of Frontend Build Systems
- URL: https://sunsetglow.net/posts/frontend-build-systems.html
- Added At: 2024-07-27 10:39:12

## TL;DR
前端构建系统通过转译、打包和压缩等步骤，解决语言特性支持不足和性能问题。转译工具如Babel将现代JavaScript转换为旧版本，打包工具如Webpack合并文件减少请求，压缩工具如Terser减少文件大小。此外，元框架和构建工具提供预配置系统，源映射支持调试，热重载提高开发效率，单一代码库促进多团队协作。趋势显示，性能导向的新工具和SSR的普及是当前的发展方向。

## Summary
1. **前端构建系统的必要性**：
   - **语言特性支持不足**：由于JavaScript在不同浏览器和版本中的兼容性问题，使用某些语言特性会减少可执行代码的客户端数量。此外，如JSX等扩展语法在浏览器中无法运行。
   - **性能问题**：直接将JavaScript源代码发送给客户端会导致大量HTTP请求，尤其是在HTTP/2之前，还会导致大量TLS握手。此外，多个JavaScript文件的顺序加载会导致“瀑布问题”，增加加载时间。源文件由于长变量名和空白字符，也会增加带宽使用和网络加载时间。

2. **前端构建系统的步骤**：
   - **转译**：将现代JavaScript标准转换为旧版本，解决不支持的语言特性问题。常用工具包括Babel、SWC和TypeScript Compiler。
   - **打包**：将多个JavaScript源文件合并成一个输出文件，减少网络请求和解决瀑布问题。常用工具包括Webpack、Parcel、Rollup、esbuild和Turbopack。
   - **压缩**：通过缩短变量名、消除空白和注释、消除死代码等方式减少文件大小。常用工具包括Terser、esbuild和SWC。

3. **转译详解**：
   - **语言特性转换**：将现代JavaScript转换为ES6/ES2015等旧版本，解决浏览器兼容性问题。
   - **框架和工具的转译需求**：如JSX语法需要转译为JavaScript，TypeScript、CoffeeScript和Elm也需要转译。
   - **模块系统转换**：将CommonJS模块转换为浏览器兼容的ES6模块，便于优化和树摇。

4. **打包详解**：
   - **解决网络请求问题**：通过合并文件减少请求数量，提高加载效率。
   - **代码分割**：将大应用分割成多个小包，优化加载性能，但可能重新引入瀑布问题。
   - **树摇**：通过静态分析移除未使用的导出，优化包大小。
   - **静态资源处理**：在打包过程中处理和优化CSS、图像和字体等静态资源。

5. **压缩详解**：
   - **减少文件大小**：通过各种优化手段减少JavaScript和CSS文件的大小，提高加载速度。

6. **增强工具**：
   - **元框架**：提供预配置的构建系统，如Next.js和Remix，专注于特定应用范式。
   - **构建工具**：如Vite，提供预配置的构建系统，适用于通用前端应用。

7. **源映射**：
   - **调试支持**：通过源映射将构建后的代码映射回原始源代码，便于调试。

8. **热重载与模块替换**：
   - **提高开发效率**：通过热重载和模块替换技术，减少代码变更到应用更新的延迟。

9. **单一代码库（Monorepos）**：
   - **多团队协作**：在单一仓库中管理多个JavaScript包，通过工具如Nx和Turborepo协调构建过程。

10. **趋势**：
    - **性能导向**：新的构建工具倾向于使用编译语言并强调性能，但可能与某些库不兼容，导致旧代码库难以迁移。
    - **服务器端渲染（SSR）**：随着Next.js的流行，SSR变得更加普遍，但对前端构建系统没有根本性影响。
