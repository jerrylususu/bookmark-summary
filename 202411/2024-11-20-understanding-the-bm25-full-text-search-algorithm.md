# Understanding the BM25 full text search algorithm
- URL: https://emschwartz.me/understanding-the-bm25-full-text-search-algorithm/
- Added At: 2024-11-20 14:30:29

## TL;DR
文章介绍了BM25算法在全文搜索中的应用，特别是其在个性化推荐系统中的潜力。BM25通过概率排序原则和多个组件（如IDF、词频和文档长度归一化）来计算文档与查询的相关性。尽管BM25分数可在同一文档集合内比较，但不能跨集合或时间比较。文章还推荐了进一步阅读资源以深入了解BM25。

## Summary
1. **BM25简介**：
   - BM25（Best Match 25）是一种广泛使用的全文搜索算法，默认应用于Lucene/Elasticsearch和SQLite等系统。
   - 近年来，BM25常与向量相似性搜索结合，形成“混合搜索”。

2. **动机**：
   - 作者构建个性化内容推荐系统，使用向量相似性搜索，但发现无法有效处理精确关键词。
   - 问题：能否跨查询比较BM25分数以确定文档最佳匹配的查询？

3. **文档排序**：
   - 全文搜索算法的目标是根据查询找到最相关的文档。
   - 通过概率排序原则，基于文档与查询的相关性概率进行排序。

4. **BM25组件**：
   - **查询词**：多个查询词分别计算分数后求和。
   - **逆文档频率（IDF）**：衡量查询词在整个文档集合中的稀有度，稀有词权重更高。
   - **文档中词频**：查询词在文档中出现的频率，但有递减收益。
   - **文档长度归一化**：根据文档长度与平均长度的比较进行调整，避免长文档不公平地获得高分。

5. **数学公式**：
   - 详细解释了BM25公式的各个部分，包括IDF、词频和文档长度归一化。
   - 通过调整参数k1和b来控制词频递减和文档长度归一化的程度。

6. **BM25的巧妙之处**：
   - **概率排序**：在不计算实际概率的情况下，通过简化公式实现概率排序。
   - **假设大多数文档不相关**：通过假设大多数文档不相关，简化了计算过程，使BM25更实用。

7. **结论**：
   - BM25分数可以在同一文档集合内进行比较，以确定文档最佳匹配的查询。
   - 不能跨集合或时间比较分数，因为IDF和平均文档长度会随集合变化。

8. **进一步阅读**：
   - 推荐了Elastic工程师Britta Weber的演讲和Stephen Robertson等人的论文，以深入了解BM25的理论和历史。
   - 提及了其他算法（如TF-IDF和Postgres）的比较，但未在此文中详细讨论。
