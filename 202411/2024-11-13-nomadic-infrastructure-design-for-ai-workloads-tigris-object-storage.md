# Nomadic Infrastructure Design for AI Workloads | Tigris Object Storage
- URL: https://www.tigrisdata.com/blog/nomadic-compute/
- Added At: 2024-11-13 14:36:34

## TL;DR
文章通过Taco Bell比喻，阐述了如何使用简单组件构建复杂AI推理系统。讨论了计算、网络、存储的基本要素及成本优化，强调动态实例化和按需扩展的重要性，并提出减少供应商锁定的设计原则。最终，推荐使用Tigris的无出口费用存储服务，以简化数据处理成本。

## Summary
1. **引言**：
   - **Taco Bell比喻**：Taco Bell通过简单的食材组合创造出多样化的菜单，类比于设计系统时使用简单、广泛理解的组件（如S3、Postgres、HTTP、JSON、YAML等）来构建复杂的系统。
   - **AI推理服务的现状**：许多公司提供AI推理服务，但很少有人解释如何自己构建这样的系统。

2. **工作负载的基本要素**：
   - **计算**：执行代码和进行数学运算的部分。
   - **网络**：允许拨号和接受套接字的部分。
   - **存储**：记住事物以备下次使用的部分。
   - **云计费**：主要计费项包括计算的千兆字节-核心-秒、网络的千兆字节出口和持久存储的千兆字节。

3. **网络出口费用**：
   - **出口费用问题**：云服务提供商通常对数据出口收费，这可能导致处理大数据时成本高昂。
   - **Tigris解决方案**：Tigris提供零出口费用的对象存储，使得按需从对象存储中拉取数据比持久存储更便宜。

4. **存储与计算成本**：
   - **闲置存储成本**：在无服务器场景中，闲置存储的成本可能高于计算时间。
   - **动态实例化**：通过动态创建实例、下载模型权重、执行推理并销毁实例，可以显著降低成本。

5. **生产工作负载的请求率**：
   - **正弦曲线模式**：大多数生产工作负载的请求率遵循正弦曲线，高峰期在白天，夜间下降。
   - **按需扩展**：根据请求率动态扩展AI推理服务器，减少闲置成本。

6. **依赖性与锁定问题**：
   - **依赖性选择**：选择依赖项时应考虑减少供应商锁定，采用Taco Bell基础设施设计理念。
   - **AI模型的依赖性**：AI模型可能成为生产关键依赖，改变模型可能导致服务质量的微妙变化。

7. **生产就绪的设计**：
   - **三个基本平面**：计算平面、网络平面和存储平面。
   - **存储的重要性**：存储是工作负载的关键部分，应选择低延迟、无出口费用的存储服务。

8. **云中的引用传递语义**：
   - **引用传递**：在云中传递值的引用而不是值本身，提高效率。

9. **大队列**：
   - **队列层**：在计算层之上添加队列层，智能地分配负载，动态创建和销毁实例。

10. **代码实现**：
    - **示例代码**：展示了如何使用Go语言实现一个简单的HTTP代理，动态创建和销毁实例。
    - **Vast.ai CLI**：使用Vast.ai CLI搜索、创建和销毁实例。

11. **结论**：
    - **设计原则**：设计生产集群时，利用广泛理解的组件（如HTTP、队列、对象存储），减少依赖性。
    - **未来展望**：希望通过发布这种架构设计，帮助构建未来的生产工作负载，实现负责任地使用云。

12. **试用Tigris**：
    - **无出口费用**：Tigris提供全球无出口费用的存储桶，简化数据处理成本。
