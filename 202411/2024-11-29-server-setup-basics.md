# Server Setup Basics
- URL: https://becomesovran.com/blog/server-setup-basics.html
- Added At: 2024-11-29 15:05:05
- [Link To Text](2024-11-29-server-setup-basics_raw.md)

## TL;DR
本文详细介绍了服务器设置的多个方面，包括SSH登录、用户管理、日志管理、备份策略、网络安全、NGINX设置、工具推荐、DNS基础和Docker简介，旨在提供一个全面的服务器设置指南。

## Summary
1. **服务器设置基础**：本文旨在提供一个关于如何设置服务器的详细指南，涵盖了从基本登录到网络安全的多个方面。

2. **SSH登录**：
   - **安全登录**：推荐使用SSH密钥进行登录，避免使用用户名和密码。
   - **创建新用户**：在VPS上创建一个新用户并添加到sudo组。
   - **生成SSH密钥**：在本地机器上生成SSH密钥，并将公钥复制到服务器。
   - **配置SSH**：修改SSH配置文件以禁用密码登录和root登录，仅允许特定用户通过SSH登录。
   - **进一步锁定登录**：使用SSH协议2，限制认证尝试次数，设置客户端活动间隔等。

3. **用户管理**：
   - **最小权限原则**：为每个应用创建独立用户，限制其权限，以减少潜在的安全风险。
   - **创建非登录用户**：使用`useradd`命令创建不能登录的用户，用于运行特定应用。
   - **应用文件管理**：将应用文件克隆到`/opt`目录，并设置正确的所有权。

4. **日志管理**：
   - **日志轮转**：设置日志轮转以防止日志文件占用过多空间，并方便管理和阅读。
   - **日志轮转配置**：编辑`logrotate.conf`文件，为NGINX等应用设置日志轮转规则。
   - **高级日志工具**：推荐使用Grafana Loki、Graylog和Fluentd等工具进行多服务器日志管理。

5. **备份策略**：
   - **备份类型**：包括全量备份、差异备份和增量备份，各有优缺点。
   - **存储策略**：遵循3-2-1规则，即3份数据副本，2种存储类型，1份异地备份。
   - **备份软件**：推荐使用SyncThing、Borg Backup和FTP等工具进行备份。

6. **基本网络安全**：
   - **防火墙设置**：使用UFW设置默认的入站拒绝和出站允许规则，并开放必要的端口（如SSH、HTTP和HTTPS）。
   - **Fail2Ban**：安装Fail2Ban以自动封禁多次登录失败的IP地址，提高服务器安全性。

7. **NGINX设置**：
   - **NGINX简介**：NGINX是一个高性能的Web服务器、反向代理和负载均衡器。
   - **配置文件管理**：使用`sites-available`和`sites-enabled`目录管理多个站点的配置文件。
   - **基本配置**：提供静态网站、代理转发和WebSocket升级的配置示例。
   - **SSL证书**：推荐使用Certbot获取和管理SSL证书，并设置自动续期。

8. **提高生活质量的工具**：
   - **资源监控**：推荐使用Btop监控服务器资源使用情况。
   - **网络连接监控**：使用Neoss查看服务器上的TCP和UDP连接。
   - **日志分析**：使用GoAccess进行实时日志分析，并生成HTML、JSON和CSV报告。
   - **文件管理**：推荐使用MC（Midnight Commander）和NCDU（NCurses Disk Usage）进行文件和磁盘管理。

9. **DNS基础**：
   - **DNS简介**：DNS将域名转换为IP地址，是互联网的核心组成部分。
   - **动态DNS**：解决家庭服务器动态IP地址的问题，推荐使用DDNS服务自动更新DNS记录。

10. **Docker**：
    - **Docker简介**：Docker是一个用于开发、测试和部署应用的容器化平台。
    - **优点**：提供一致性、隔离性、效率和可扩展性。
    - **缺点**：增加系统开销、潜在的安全风险、数据持久化和网络复杂性。

11. **总结**：本文涵盖了服务器设置的基本步骤和工具，并提供了一个自动化脚本以简化设置过程。
