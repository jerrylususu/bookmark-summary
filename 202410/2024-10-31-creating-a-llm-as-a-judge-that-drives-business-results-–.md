# Creating a LLM-as-a-Judge That Drives Business Results –
- URL: https://hamel.dev/blog/posts/llm-judge/
- Added At: 2024-10-31 14:44:25
- [Link To Text](2024-10-31-creating-a-llm-as-a-judge-that-drives-business-results-–_raw.md)

## TL;DR
文章提出通过“批评影子”技术解决AI团队在构建系统时的数据过载问题，包括找到领域专家、创建多样性数据集、指导专家进行通过/失败判断、修复错误、迭代构建LLM法官、进行错误分析等步骤，强调数据分析和反馈循环的重要性。

## Summary
1. **问题背景**：
   - **AI团队数据过载**：AI团队在构建AI系统时，常常花费数周时间，却无法确定系统是否真正有效。常见问题包括：
     - **过多指标**：创建了大量难以管理的测量指标。
     - **任意评分系统**：使用未经校准的评分尺度（如1-5），评分差异不明确且主观。
     - **忽视领域专家**：未充分考虑深入理解业务的人。
     - **未验证的指标**：使用的测量方法无法真正反映用户或业务的需求。

2. **解决方案**：
   - **使用“批评影子”技术**：通过逐步过程避免上述陷阱。

3. **步骤1：找到主要领域专家**：
   - **重要性**：
     - **设定标准**：领域专家不仅定义技术上的可接受性，还帮助理解用户实际需求。
     - **捕捉未明言的期望**：通过评估过程，帮助专家明确“可接受的”AI交互。
     - **判断一致性**：确保评估与最关键的标准一致。
     - **归属感**：让专家参与AI开发，增加他们的投资感和最终批准的可能性。
   - **示例**：心理学家、律师、客户服务总监、教育工具的课程开发者等。

4. **步骤2：创建数据集**：
   - **多样性数据集的重要性**：
     - **全面测试**：确保AI在各种情况下得到评估。
     - **真实交互**：反映实际用户行为，进行更相关的评估。
     - **识别弱点**：帮助发现AI可能出错的领域。
   - **数据集结构维度**：
     - **特征**：AI产品的特定功能。
     - **场景**：AI可能遇到的情况或问题。
     - **角色**：具有不同特征和需求的用户代表。
   - **生成数据**：
     - **使用现有数据**：从AI系统中采样真实用户交互。
     - **生成合成数据**：使用LLM创建覆盖各种特征、场景和角色的真实用户输入。

5. **步骤3：指导领域专家进行通过/失败判断并提供批评**：
   - **简单通过/失败指标的重要性**：
     - **清晰和聚焦**：二元决策迫使考虑真正重要的事项。
     - **可操作的见解**：易于解释和执行，帮助快速识别AI是否满足用户需求。
     - **明确期望**：通过通过/失败决策，领域专家必须明确表达他们的期望。
     - **资源高效利用**：保持评估过程可管理，避免陷入详细但无意义的指标。
   - **批评的作用**：
     - **捕捉细微差别**：批评允许指出大部分正确但有改进空间的地方。
     - **指导改进**：详细反馈提供具体见解，指导AI如何增强。
     - **平衡简单与深度**：通过/失败提供清晰裁决，批评提供理解判断所需的深度。

6. **步骤4：修复错误**：
   - **发现并修复AI系统中的明显错误**：在构建LLM法官之前修复错误。

7. **步骤5：迭代构建LLM法官**：
   - **隐藏的批评力量**：无法在看到数据之前写出好的法官提示。
   - **从专家示例开始**：使用领域专家的示例构建法官提示。
   - **迭代提示直到与领域专家一致**：通过迭代改进提示，直到法官与专家判断达成一致。
   - **优化法官提示**：通常手动调整提示，避免使用通用评估框架。
   - **人类过程**：构建LLM法官的过程帮助领域专家更清晰地表达评估标准。
   - **评估频率**：定期或材料变化时进行人类审查。
   - **失败情况**：AI过度扩展、过程未正确遵循、对对齐期望不切实际等。

8. **步骤6：进行错误分析**：
   - **计算不同维度的错误率**：通过分类错误，识别根本原因并修复。
   - **分类跟踪**：手动分类错误示例，计算错误分布。
   - **再次修复错误**：每次修复错误后，尝试编写测试用例。
   - **数据素养要求**：进行良好的数据分析需要实践和基本的数据分析工具知识。

9. **步骤7：创建更多专门的LLM法官（如有需要）**：
   - **根据错误分析决定是否投资更多专门的LLM法官**：例如，针对引用来源正确性创建专门的评估。

10. **总结**：
    - **批评影子过程**：迭代过程，通过反馈循环不断改进。
    - **价值来源**：真正价值在于查看数据并进行仔细分析，而不仅仅是创建LLM法官。
    - **是否需要此过程**：取决于具体情况，有时可以跳过某些步骤。

11. **常见问题解答**：
    - **好的法官LLM是否也是想使用的LLM**：有效法官通常使用更大模型或更多计算资源。
    - **是否推荐微调法官**：更倾向于微调实际LLM而非法官。
    - **现成LLM法官的问题**：可能导致更多混淆而非价值。
    - **如何评估LLM法官**：收集领域专家与法官之间的一致性指标。
    - **使用什么模型作为LLM法官**：根据成本/延迟预算选择最强大的模型。
    - **关于护栏**：护栏是防止LLM产生有害或不适当内容的机制。
    - **未遵循此方法但仍获得巨大价值**：此博客文章并非唯一使用LLM法官的方法。
    - **传统ML技术、LLM法官和人工注释的选择**：选择最简单有效的方法。
    - **从小模型创建法官**：可能，但需基于数据（即与领域专家的一致性）。
    - **确保更新LLM模型的一致性**：再次进行过程并测量结果。
    - **逐步减少人类参与以扩展**：无需领域专家评估每个示例，只需代表性样本。

12. **资源**：
    - **推荐资源**：包括博客文章、论文和工具，帮助深入了解此主题。

13. **保持联系**：
    - **订阅以获取最新见解和内容**：定期邮件分享LLM的最新发现，无垃圾邮件。
