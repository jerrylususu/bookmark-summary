# Minimal CSS-only blurry image placeholders
- URL: https://leanrada.com/notes/css-only-lqip/
- Added At: 2025-04-03 13:21:49
- [Link To Text](2025-04-03-minimal-css-only-blurry-image-placeholders_raw.md)

## TL;DR


本文提出仅用CSS单变量(--lqip)实现极简模糊占位图的方法。通过20位整数位打包压缩Oklab色彩和灰度块信息，CSS解码后叠加6个径向渐变生成模糊效果。相比其他方案无需额外HTML/JS，但受制于20位编码精度导致严重模糊，适合对性能要求极高的场景。后续可结合新标准提升效果。

## Summary


本文介绍了如何仅用CSS实现极简模糊图片占位符（LQIP），无需额外HTML标记或JavaScript。核心方法是通过单个自定义属性`--lqip`存储编码值，解码后生成模糊图像。关键技术点如下：

### 核心原理
1. **位打包编码**  
   将图像信息压缩为整数，通过位运算解压：
   - 使用20位整数编码：基色（8位Oklab色彩空间）+6个灰度块（2位/个）
   - 解码通过CSS计算：位移/取模运算提取各部分数值

2. **渐变渲染**  
   用6个径向渐变模拟灰度分布，叠加于基色上：
   - 3×2网格布局覆盖图像区域
   - 渐变边缘通过二次插值模拟平滑过度（需手动定义多段透明度）

### 现有方案比较
| 方法 | 特点 | 局限 |
|------|------|------|
| 低分辨率图片 | 对比度保留好 | 网络传输仍有开销 |
| SQIP/SVG | 支持矢量 | 标记复杂度高 |
| BlurHash | 基于字符串编码 | 需JavaScript解码 |
| 本文方案 | 单变量CSS实现 | 效果极其模糊 |

### 技术细节
- **CSS整数限制**：浏览器支持-999,999~999,999区间，提供约20位有效编码空间
- **色彩压缩**：
  - 基色：L（2bit）+a（3bit）+b（3bit）
  - 灰度块：每块2bit映射至0-100%亮度
- **优化技巧**：通过多层渐变叠加（实际实现加倍层数）与边缘羽化模拟双线性插值效果

### 未来改进方向
1. 等待CSS `attr()`标准普及，改用自定义HTML属性（如`<img lqip="123456">`）
2. 探索遗传算法优化编码精度（受限于CSS渲染模拟器开发）
3. 希望浏览器支持渐变非线性插值原生实现

该方案以极端精简的代码代价（仅需添加自定义属性）实现基础LQIP效果，适合对页面性能极度敏感的场景，但视觉质量显著受限于20位信息量。
