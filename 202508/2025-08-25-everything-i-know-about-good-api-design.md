# Everything I know about good API design
- URL: https://www.seangoedecke.com/good-api-design/
- Added At: 2025-08-25 07:07:26

## TL;DR


本文总结了API设计的核心原则：平衡熟悉性与灵活性，避免破坏用户系统，版本化为最后手段。强调产品价值优先于API设计，优先采用API密钥认证，并确保关键操作的幂等性及速率限制。推荐游标分页提升性能，反对过度使用GraphQL。内部API可灵活调整，但需维护核心稳定性。核心准则为保持简单一致，优先用户友好性，重视可维护性。

## Summary


**好的API设计的核心原则与实践：**  

**1. API设计的核心矛盾：**  
- **平衡“熟悉性”与“灵活性”**：优秀的API应“平淡无奇”，让用户无需过多学习即可使用。复杂或“有趣”的设计反而会阻碍开发者使用。  
- **不可破坏现有用户空间**：一旦API公开，任何破坏性变更都可能破坏用户系统，需严格遵守“不破坏用户空间”原则。**变更代价巨大**，需尽量避免。  

**2. 版本控制的必要性与弊端：**  
- **版本化是最后手段**：当必须进行破坏性变更时，通过 `/v1/`、请求头等方式支持多版本并存，允许用户逐步迁移。但版本管理会增加维护成本，需谨慎使用。  

**3. API成功的关键驱动因素：**  
- **产品价值远胜于API质量**：用户选择API的核心因素是产品本身。若产品足够有用，即使API设计糟糕，用户也会接受；反之，若产品设计混乱，API难以优雅。  

**4. 认证与访问控制：**  
- **优先支持API密钥**：简单易用，尤其适配非开发人员（如销售、产品经理）。OAuth等复杂方案应作为补充选项。  

**5. 可靠性与容错设计：**  
- **幂等性设计**：对关键操作（如支付、数据修改）添加“幂等性键”，避免重复提交导致错误。未修改（如删除操作）可通过资源ID天然支持幂等性。  
- **速率限制与熔断机制**：防止滥用或意外流量激增，需设置 API 调用速率限制并保留紧急禁用能力。  

**6. 数据分页与查询效率：**  
- **游标分页优于偏移分页**：避免大规模数据访问时的性能瓶颈，推荐采用 “cursor-based pagination”（如 `/endpoint?cursor=32`），尤其适用于可能增长的数据集。  

**7. GraphQL的争议观点：**  
- **反对过度使用GraphQL**：虽提供灵活性，但增加了学习成本与后端复杂性，且缓存效率较低。建议仅在必要时采用。  

**8. 内部API的特殊性：**  
- **可更灵活变更**：针对公司内部团队，可快速调整或打破兼容性，但仍需保障核心操作的幂等性与稳定性。  

**总结关键点：**  
- **核心准则**：避免破坏用户空间，保持API的简单性和一致性。  
- **变更管理**：版本化是最坏选择，需权衡长期维护成本。  
- **产品优先**：API质量是次要竞争力，产品价值才是根本。  
- **用户友好**：设计需支持非专业用户的使用场景，如简单认证、明确错误反馈。  
- **可维护性**：通过幂等性、分页策略、限流机制提升可靠性与扩展性。  

**未深入讨论的领域**：  
- 未过多涉及REST与SOAP等具体协议选择，作者倾向REST/JSON但认为技术选型非绝对。  
- 对OpenAPI规范态度中立，认为文档清晰即可，不强制使用特定工具。
