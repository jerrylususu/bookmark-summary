# Tools: Code Is All You Need
- URL: https://lucumr.pocoo.org/2025/7/3/tools/
- Added At: 2025-07-03 14:27:37

## TL;DR


本文指出Model Context Protocol（MCP）存在缺乏组合性、上下文效率低等缺陷，认为代码生成更适于自动化任务，因其具备可验证性（如通过脚本比对转换结果）、低成本重复执行及场景适应性优势。以文档格式转换为例，通过AST解析、差异脚本比对和迭代优化三步拆解验证流程，展示代码方法的可靠性。建议优先采用代码处理重复或复杂任务，并探索LLM与代码协作的新抽象层，同时开发附带自然语言解释的自动化工具以提升非编程用户使用体验。

## Summary


本文探讨了Model Context Protocol（MCP）的缺陷及代码生成的优势，提出通过代码而非MCP实现自动化任务的实践路径。主要内容如下：

### **MCP的缺陷**
1. **缺乏真正组合性**：大部分功能通过推理拼接，无法高效复用工具。
2. **过度依赖上下文**：初始输入和工具调用会消耗大量上下文空间，效率低于直接编写代码。

### **替代方案：代码生成的优势**
- **可验证性**：代码能被人工审查或通过脚本验证，减少推理错误风险。例如作者将文档格式转换为多步代码验证流程，确保结果可靠。
- **重复执行成本低**：代码生成的自动化脚本可无限次重复执行，而MCP每次调用均需重复推理，成本随任务量上升。
- **场景适应性**：在特定任务（如控制自有应用的浏览器操作）中，生成代码比MCP更高效，且无需实时推理。

### **案例：文档格式转换**
作者将reStructuredText转Markdown的过程拆解为三步：
1. **代码转换**：通过解析AST生成代码实现格式转换。
2. **差异对比脚本**：编写脚本自动比对原始HTML与生成HTML，排除技术限制导致的差异。
3. **迭代优化**：通过循环反馈调整代码，最终完成大规模转换。

### **MCP的局限性**
- **难以替代代码自动化**：MCP在远程控制等场景依赖逐层推理，而代码可一次性生成执行流程，速度和可靠性更优。
- **调试与扩展困难**：MCP调用过程难以追踪和调试，而代码可无缝集成到工作流。

### **未来方向**
- **结合代码与LLM优势**：利用LLM生成代码并由代码执行核心任务，仅在关键步骤调用LLM进行验证或判断。
- **开发非编程用户工具**：生成代码时附带自然语言解释，让非开发者也能理解并使用自动化脚本。

### **关键结论**
- **代码优先**：对于需重复执行或复杂任务，代码生成比MCP更具可验证性和扩展性。
- **MCP的适用场景受限**：仅在真实交互（如动态网页操作）等需实时推理的场景中可能有价值。
- **技术建议**：探索代码生成与LLM协作的新抽象层，降低自动化任务的推理依赖。
