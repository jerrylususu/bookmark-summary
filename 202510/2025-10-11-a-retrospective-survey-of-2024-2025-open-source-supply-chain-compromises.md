# A Retrospective Survey of 2024/2025 Open Source Supply Chain Compromises
- URL: https://words.filippo.io/compromise-survey/
- Added At: 2025-10-11 13:32:24

## TL;DR
2024-2025年开源供应链攻击主要涉及钓鱼、项目控制权转让、高危CI触发器和凭证泄露。建议维护者强制启用防钓鱼认证，严格管控权限，弃用危险CI触发器，以增强项目安全性。

## Summary
本文基于2024至2025年公开的开源软件供应链攻击案例，分析了根因并提出了相应的缓解措施。分析范围聚焦于项目维护者能主动防护的领域，不包括故意恶意软件包、包管理器漏洞等外部因素。

### 主要攻击向量及根因
- **钓鱼攻击（5次根因）**：最常见的初始入侵方式，即使启用TOTP双因素认证仍可能失效。专业维护者应使用防钓鱼认证（如passkeys或WebAuthn 2FA），并保护上游账户（如邮箱、域名注册商）。
- **控制权转让（3+1次根因）**：攻击者通过长期施压或项目交接获得访问权限。解决需依赖开源维护的可持续性，避免非必要交接。
- **GitHub Actions高危触发器（4次根因）**：
  - `pull_request_target`和`issue_comment`等触发器在特权环境下运行，易受注入攻击。建议完全避免使用此类触发器，改用安全替代方案（如外部Webhook服务或`workflow_run`触发器）。
- **长期凭证泄露（2+3次根因，5次促成因素）**：令牌被盗是常见横向移动手段。缓解措施包括：
  - 使用无账户机制的生态（如Go语言）。
  - 采用Trusted Publishing等短期令牌方案。
  - 限制GitHub个人访问令牌（PAT）的使用范围。
- **域名/用户名复活（1次根因）**：过期域名或变更的GitHub用户名被攻击者利用。维护者应长期注册关键域名，避免频繁更改用户名。
- **其他促成因素**：
  - **CI写入权限**：即使只读工作流也可能通过缓存中毒实现权限提升，目前缺乏有效缓解。
  - **安装后脚本**：npm等生态的脚本执行风险可通过`ignore-scripts true`配置缓解。
  - **不可复现的发布文件**：如XZ后门事件，需推动构建可复现性。
  - **可变GitHub Actions标签**：标签可变性导致依赖方瞬间被劫持，应改用固定提交哈希。
  - **分支持久化CI配置**：安全更新需同步到所有分支，包括陈旧分支。

### 核心缓解建议
作为专业维护者的责任，以下三点应优先落实：
1. **强制启用防钓鱼认证**。
2. **严格控制访问权限，避免非必要交接**。
3. **彻底弃用高危GitHub Actions触发器**（如`pull_request_target`）。

### 总结
开源供应链安全需系统性改进，维护者应主动采用可落地的防护措施，减少低层次漏洞。本文研究旨在推动行业制定更严格的安全标准（如Geomys标准），提升关键项目的抗攻击能力。
