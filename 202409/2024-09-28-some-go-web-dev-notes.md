# Some Go web dev notes
- URL: https://jvns.ca/blog/2024/09/27/some-go-web-dev-notes/
- Added At: 2024-09-28 03:26:52
- [Link To Text](2024-09-28-some-go-web-dev-notes_raw.md)

## TL;DR
文章总结了Go 1.22的路由改进、sqlc代码生成工具、SQLite优化技巧、Go 1.19的内存限制设置、Go开发网站的优势及对Go新特性的关注。强调了Go在简化开发、优化性能和易于维护方面的优势。

## Summary
1. **Go 1.22路由改进**：
   - 作者之前手动处理路由，未使用第三方库如`gorilla/mux`或`chi`。
   - Go 1.22在标准库中增强了路由支持，简化了路由代码。
   - 示例代码展示了如何使用新的路由功能，并提到可能需要登录中间件。

2. **sqlc自动生成代码**：
   - 作者厌倦了为SQL查询编写大量样板代码，但不想学习ORM。
   - 发现`sqlc`工具，能将SQL查询自动转换为Go代码。
   - 通过示例展示了`sqlc`如何将简单的SQL查询转换为Go函数。
   - 阅读了Brandur关于`sqlc`的笔记，增加了对使用`sqlc`的信心。

3. **SQLite优化技巧**：
   - 从Mastodon上的一篇文章中学习了优化SQLite的技巧。
   - 建议为写操作设置专用对象，并限制并发写入。
   - 提到可以为读操作和写操作分别设置数据库对象以提高性能。
   - 其他优化技巧包括使用STRICT表和避免慢速的COUNT查询。

4. **Go 1.19的GC内存限制**：
   - 作者在内存有限的VM中运行Go应用，遇到OOM问题。
   - 通过设置`GOMEMLIMIT`限制内存使用，减少了OOM的发生。
   - 示例展示了如何设置`GOMEMLIMIT`。

5. **喜欢用Go开发网站的原因**：
   - 只需一个静态二进制文件，部署简单。
   - 内置的Web服务器适合生产环境，无需配置WSGI。
   - Go的工具链安装简单，构建项目方便。
   - `net/http`在标准库中，无需额外安装库即可开发网站。
   - Go语言系统性强，易于处理底层操作。
   - 项目易于维护，即使长时间不接触也能快速上手。

6. **对Go新特性的关注**：
   - 提到`GOMEMLIMIT`和路由改进是近几年的新特性。
   - 建议应更关注Go的版本发布说明，以利用新功能。
