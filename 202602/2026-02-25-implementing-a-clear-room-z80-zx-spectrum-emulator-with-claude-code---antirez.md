# Implementing a clear room Z80 / ZX Spectrum emulator with Claude Code - <antirez>
- URL: https://antirez.com/news/160
- Added At: 2026-02-25 15:19:25
- Tags: #read #agent #deepdive

## TL;DR
作者antirez通过“干净房间”实验，让Claude Code在无外部信息条件下编写Z80/ZX Spectrum模拟器，验证了AI能基于详尽规范生成原创代码，反驳了AI仅复制训练数据的观点。

## Summary
作者antirez对Anthropic的“干净房间”实验（让Claude Opus 4.6在无外部信息的情况下编写C编译器）的方法论提出了质疑，并决定亲自进行一个类似的实验：使用Claude Code在“干净房间”条件下编写一个Z80/ZX Spectrum模拟器。

**实验过程与方法：**
1.  **准备阶段**：作者首先编写了一份详细的Markdown规范文件，定义了模拟器的功能、设计目标（如为嵌入式设备优化）以及Claude需要遵循的规则（如禁止上网、禁止搜索现有代码、必须编写测试、代码需简洁且注释详尽）。
2.  **信息收集**：启动Claude Code会话，让其从互联网上搜集Z80和ZX Spectrum的技术文档，并提取关键信息生成Markdown文件。随后，作者删除了该会话，以确保后续实现阶段不受搜索阶段的代码污染。
3.  **实现阶段**：启动一个新的Claude Code会话，基于准备好的规范和文档文件，开始编写Z80模拟器。在此期间，作者禁止Claude访问互联网，并未进行任何引导（Z80部分）或进行了少量引导（Spectrum部分，主要针对TAP文件加载）。
4.  **验证阶段**：作者将代码库复制并删除Git历史，让Claude和Codex检查是否存在代码抄袭，结果未发现版权问题，证明了实现的独特性。

**实验结果：**
*   **Z80模拟器**：Claude Code在20-30分钟内生成了1200行C代码，成功通过了ZEXDOC和ZEXALL测试。实现过程是增量式的，通过不断测试和调试完成，而非一次性生成完整代码。
*   **ZX Spectrum模拟器**：在更详细的设计规范下，Claude Code在10分钟内完成了实现，并成功运行了《Jetpac》游戏。作者随后引导Claude修改了代码结构以支持TAP文件加载。
*   **CP/M环境**：基于之前的测试需求，Claude Code快速实现了CP/M环境，支持了WordStar等软件。

**核心结论与思考：**
1.  **有效提示的重要性**：成功的关键在于为AI提供详尽的设计规范和文档，这类似于人类程序员的工作方式。
2.  **AI的编程能力**：AI并非简单地“解压”训练集中的代码，而是能综合运用多种知识，生成新的、符合特定约束的代码。这反驳了AI仅是记忆和复制的观点。
3.  **与人类编程的对比**：人类程序员常通过阅读现有代码获取灵感，而AI在“干净房间”条件下也能生成高质量代码，这表明AI生成的代码具有原创性。
4.  **开源与许可**：基于上述原因，作者认为使用AI生成的代码可以放心地以MIT许可证开源，这些代码将成为未来LLM训练的优质数据。
