# Building a full-text search engine in 150 lines of Python code
- URL: https://bart.degoe.de/building-a-full-text-search-engine-150-lines-of-code/
- Added At: 2026-02-07 15:05:46
- Tags: #read #deepdive

## TL;DR
本文介绍如何用Python在150行代码内构建简单全文搜索引擎，使用维基百科数据，涵盖数据解析、倒排索引、布尔搜索和TF-IDF排名。引擎在内存中快速处理百万文档，但非生产级，代码已开源。

## Summary
本文介绍了如何使用Python在150行代码内构建一个简单的全文搜索引擎。文章以维基百科摘要数据为例，详细说明了从数据准备到搜索排名的完整流程。

**数据准备**：使用维基百科的摘要XML文件（约785MB，包含627万条摘要），通过流式解析提取标题、URL和摘要内容，并封装为Python数据类。

**索引构建**：采用倒排索引结构。首先对文本进行分析，包括分词、小写化、去除标点、过滤停用词（如常见英语单词和“Wikipedia”）以及词干提取（如将“brewery”和“breweries”统一为词干）。分析后的词项映射到文档ID，存储在字典中。

**搜索功能**：支持布尔搜索，包括AND（返回包含所有查询词的文档）和OR（返回包含任意查询词的文档）模式。搜索时先分析查询词，然后在索引中查找匹配文档。

**排名算法**：基于TF-IDF（词频-逆文档频率）计算文档相关性。词频（TF）表示词项在文档中的出现次数，逆文档频率（IDF）降低常见词的权重。得分越高，文档越相关，结果按得分排序。

**性能与局限**：引擎在内存中运行，可快速处理百万级文档，但非生产级解决方案。文章最后提出扩展方向，如添加字段权重（如标题匹配权重更高）和改进查询解析。

所有代码已在GitHub开源，读者可自行实验。
